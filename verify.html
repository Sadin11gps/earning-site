<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verify Account - Student Best Income</title>
<style>
body { font-family: Arial, sans-serif; background:#f0f4f8; text-align:center; margin:0; }
header { background:#3b82f6; color:white; padding:15px; font-size:24px; font-weight:bold; }
.container { background:#e0f2fe; padding:20px; margin:20px auto; border-radius:10px; width:90%; max-width:450px; }
input, select { width:90%; padding:10px; margin:10px 0; border-radius:5px; border:1px solid #ccc; font-size:16px; }
button { padding:10px 20px; border:none; border-radius:5px; background:#10b981; color:white; font-size:16px; font-weight:bold; cursor:pointer; transition:0.3s; }
button:hover { background:#059669; }
p { margin-top:15px; }
.success { color:green; font-weight:bold; }
.error { color:red; font-weight:bold; }
.copyBtn { background:#3b82f6; margin-left:10px; }
</style>
</head>
<body>

<header>üåü Verify Account üåü</header>

<div class="container" id="verifyContainer">
    <p id="message">Loading...</p>
    
    <div id="payForm" style="display:none;">
        <h3>Pay Cash Form</h3>
        <p>‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶è‡¶ï‡¶á ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶∏‡ßç‡¶•‡¶æ‡¶®‡¶æ‡¶®‡ßç‡¶§‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶è‡¶°‡¶º‡¶æ‡¶§‡ßá ‡¶∏‡¶†‡¶ø‡¶ï TxnID ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§<br>
        ‡¶è‡¶á ‡¶¨‡¶ø‡¶ï‡¶æ‡¶∂ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏‡ßã‡¶®‡¶æ‡¶≤ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá ‡¶Ö‡¶∞‡ßç‡¶• ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶§‡ßá Send Money ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</p>
        
        <p>
            Personal: <span id="personalNumber">01338553254</span>
            <button class="copyBtn" onclick="copyNumber()">Copy</button>
        </p>
        
        <p>
            Method: 
            <select id="payMethod">
                <option value="bkash">Bkash</option>
                <option value="nagad">Nagad</option>
            </select>
        </p>
        
        <p>Pay: 20 Tk</p>
        
        <input type="text" id="userNumber" placeholder="Your number" required><br>
        <input type="text" id="txnId" placeholder="Txn ID" required><br>
        <button id="verifyBtn">VERIFY</button>
        <p class="success" id="successMsg"></p>
        <p class="error" id="errorMsg"></p>
    </div>
</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {  
    apiKey: "AIzaSyBEbzvJ5asGNPp85_Uyvk1N_TCjIBfECXY",  
    authDomain: "studentbestincome.firebaseapp.com",  
    databaseURL: "https://studentbestincome-default-rtdb.firebaseio.com",  
    projectId: "studentbestincome",  
    storageBucket: "studentbestincome.firebasestorage.app",  
    messagingSenderId: "261636758539",  
    appId: "1:261636758539:web:faea7afabe319a53117b0e",  
    measurementId: "G-6L77EJ7MJF"  
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

const message = document.getElementById('message');
const payForm = document.getElementById('payForm');
const verifyBtn = document.getElementById('verifyBtn');
const successMsg = document.getElementById('successMsg');
const errorMsg = document.getElementById('errorMsg');

function copyNumber(){
    const personal = document.getElementById('personalNumber').innerText;
    navigator.clipboard.writeText(personal).then(()=>{ alert('Copied: '+personal); });
}

auth.onAuthStateChanged(user=>{
    if(user){
        db.ref('users/' + user.uid).once('value').then(snapshot=>{
            const data = snapshot.val();
            if(data && data.isVerified){
                message.innerText = '‚úÖ Your account is already verified!';
            } else {
                message.innerText = '';
                payForm.style.display = 'block';
            }
        });
    } else {
        message.innerText = '‚ö†Ô∏è Please login first to verify your account.';
    }
});

verifyBtn.addEventListener('click', ()=>{
    errorMsg.innerText = '';
    successMsg.innerText = '';
    
    const userNumber = document.getElementById('userNumber').value.trim();
    const txnId = document.getElementById('txnId').value.trim();
    const payMethod = document.getElementById('payMethod').value;
    
    if(!userNumber || !txnId){
        errorMsg.innerText = 'Please fill all fields!';
        return;
    }
    
    const user = auth.currentUser;
    if(user){
        const txnKey = db.ref('users/' + user.uid + '/payment').push().key;
        db.ref('users/' + user.uid + '/payment/' + txnKey).set({
            amount: 20,
            userNumber: userNumber,
            txnId: txnId,
            method: payMethod,
            status: 'pending'
        }).then(()=>{
            successMsg.innerText = '‚úÖ Payment details submitted. Waiting for verification.';
            verifyBtn.disabled = true;
        }).catch(err=>{
            errorMsg.innerText = '‚ùå Error: '+err.message;
        });
    }
});
</script>

</body>
</html>
